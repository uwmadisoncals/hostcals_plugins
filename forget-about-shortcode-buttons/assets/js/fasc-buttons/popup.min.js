function loadTab(e){$("#button-dialog .fasc-tab-content").hide();$("#button-dialog "+e).show();if($(".ico-grid .grid-container div.active").length>0){$(".ico-grid").scrollTop($(".ico-grid .grid-container div.active").position().top-5)}}function parseButtons(e){var t=$(".saved-buttons-tab .container-grid ul");t.empty();var n="";var r=0;$.each(e,function(i){n="";var s=$(e[i]["html"]);var o=s.css("background-color");var u=s.css("color");n+="<li data-index='"+r+"'>";n+='<div class="wrap">';n+='<div class="full_button">'+e[i]["html"]+"</div>";n+='<div class="name"><span>'+e[i]["name"]+'</span> <a class="dashicons dashicons-edit fasc-button-edit"></a><a class="fa fa-check fasc-button-update" data-action="update"></a><a class="dashicons dashicons-no-alt fasc-button-update" data-action="remove"></a></div>';n+='<div class="col fasc-button-remove dashicons dashicons-no-alt"></div>';n+='<div class="col" style="background-color:'+o+';"></div>';n+='<div class="col" style="background-color:'+u+';"></div>';n+='<div class="clear"></div>';n+="</div>";n+="</li>";t.append(n);r++});var i=function(e){var t=e.text();var n=$("<input>",{val:t,type:"text",width:"170px","data-orig-text":t});e.replaceWith(n);n.select()};var s=function(e){var t=$("<span>",{text:e.attr("data-orig-text")});e.replaceWith(t);t.on("click",i)};var o=function(e){var t=$("<span>",{text:e.val()});e.replaceWith(t);t.on("click",i)};$(".fasc-button-edit").click(function(){$(this).hide();$(this).parent().find(".fasc-button-update").show().css("display","inline-block");i($(this).parent().find("span"));return false});$(".fasc-button-remove").click(function(e){e.preventDefault();var t=$(this).closest("li").attr("data-index");$.get(ajax_url+"?action=fasc_buttons&load=remove_button&index="+t,function(e){parseButtons(e)},"json");return false});$(".fasc-button-update").click(function(){var e=$(this);$(this).parent().find(".fasc-button-update").hide();$(this).parent().find(".fasc-button-edit").show();if(e.attr("data-action")=="remove"){s($(this).parent().find("input"))}else{var t=$(this).closest("li").attr("data-index");var n=encodeURIComponent($(this).parent().find("input").val());$.get(ajax_url+"?action=fasc_buttons&load=update_button&index="+t+"&name="+n,function(e){parseButtons(e)},"json");o($(this).parent().find("input"))}return false});var u=$(".saved-buttons-tab .container-grid li .wrap");u.on("click",function(){u.removeClass("active");$(this).addClass("active");var e=$(this).find(".full_button a.fasc-button");setupFormHTML(e,true);$previewButton=jQuery(".preview-button-area .centered-button");$previewButton.html(getButton())})}function getButton(e){var t={content:"",isSaving:false};$.extend(t,e);var n=jQuery("#button-dialog input#button-url").val();var r=jQuery("#button-dialog input#button-text").val();var i=jQuery("#button-dialog select#button-size").val();var s=jQuery("#button-dialog input#button-color").val();var o=jQuery("#button-dialog input#text-color").val();var u=jQuery("#button-dialog select#button-type").val();var a=jQuery("#button-dialog select#button-align").val();var f=jQuery("#button-dialog input#new-window").prop("checked");var l="";var c="";var h="";var p="";var d="";var v="";var m="";if(f==true){v=' target="_blank"'}if(u){if(u!=""){h=" "+u}}if(i){if(i!=""){p=" "+i}}var g=$($("#tab-2-content .ico-grid div.active").get(0));var y="";var b="";if(g.length==1){var w=g.attr("class").split(" ");var E=0;var S="dashicons";for(E=0;E<w.length;E++){if(w[E]!="active"&&w[E]!="fa"&&w[E]!="dashicons"){y+=" "+w[E]}if(w[E]=="fa"){S="fontawesome"}}if(E>0){if(S=="fontawesome"){y=" ico-fa fasc-ico-before"+y}else{y=" fasc-ico-before"+y}}}var x="";if(!t.isSaving){x='<a href="'+n+'" class="fasc-button'+p+h+y+'"'+v+' style="background-color:'+s+";color:"+o+';" data-fasc-style="background-color:'+s+";color:"+o+';">'+r+"</a>"}else{x='<a class="fasc-button'+p+h+y+'"'+v+' style="background-color:'+s+";color:"+o+';" data-fasc-style="background-color:'+s+";color:"+o+';"></a>'}return x}function rgb2hex(e){if(e.search("rgb")==-1){return e}else{e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return"#"+t(e[1])+t(e[2])+t(e[3])}}function setupFormHTML(e,t){var n="";var r=e.attr("href");if(typeof t=="undefined"){jQuery("#button-dialog input#button-url").val(r)}var i=e.attr("target");jQuery("#button-dialog input#new-window").prop("checked",false);if(typeof i!="undefined"){if(i=="_blank"){jQuery("#button-dialog input#new-window").prop("checked",true)}}if(typeof t=="undefined"){var s=e.text();jQuery("#button-dialog input#button-text").val(s)}var o=rgb2hex(e.css("color"));jQuery("#text-color").val(o);refreshMiniColors(jQuery("#text-color"),o);var u=rgb2hex(e.css("background-color"));jQuery("#button-color").val(u);refreshMiniColors(jQuery("#button-color"),u);var a=e.attr("class").split(/\s+/);$("#tab-2-content .ico-grid > div > div").removeClass("active");for(var f=0;f<a.length;f++){if(a[f].substring(0,9)=="fasc-type"){var l=a[f];if(e.hasClass("fasc-rounded-medium")||e.hasClass("rounded")){l=l+" "+"fasc-rounded-medium"}jQuery("#button-type option").removeAttr("selected");jQuery('#button-type option[value="'+l+'"]').attr("selected","selected");$("#button-type").val(l)}else if(a[f].substring(0,9)=="fasc-size"){var c=a[f];jQuery("#button-size option").removeAttr("selected");jQuery('#button-size option[value="'+c+'"]').attr("selected","selected");$("#button-size").val(c)}else if(a[f].substring(0,9)=="dashicons"){$("#tab-2-content .ico-grid .grid-container").removeClass("ico-screen-active");$("#tab-2-content #dashicons-grid").addClass("ico-screen-active");$("#icon-type-select").val("dashicons-grid");var h=a[f];$(".ico-grid ."+h).addClass("active");$('#tab-2-content .fasc-ico-position[value="before"]').attr("checked","checked")}else if(a[f].substring(0,3)=="fa-"){$("#tab-2-content .ico-grid .grid-container").removeClass("ico-screen-active");$button=$("#tab-2-content .ico-grid").find("."+a[f]);var p=$button.parent().attr("id");var d=$("#tab-2-content #"+p);d.addClass("ico-screen-active");$("#icon-type-select").val(p);$(".ico-grid ."+a[f]).addClass("active");$('#tab-2-content .fasc-ico-position[value="before"]').attr("checked","checked")}}}function refreshMiniColors(e,t){var n=jQuery(".preview-button-area .centered-button");e.minicolors({position:"top left",change:function(e,t){n.html(getButton())}});if(typeof t!="undefined"){e.minicolors("value",t)}}var $currentNode=null;(function(e){e(function(){e("#tab-header a").click(function(){var t=e(this);var n=t.attr("href");t.parent().parent().find("li").removeClass("active");t.parent().addClass("active");loadTab(n);return false});e("#tab-2-content #icon-type-select").change(function(t){e("#tab-2-content .ico-grid .grid-container").removeClass("ico-screen-active");e("#tab-2-content #"+e(this).val()).addClass("ico-screen-active")});e("#tab-2-content .ico-grid div").click(function(t){t.preventDefault();e("#tab-2-content .ico-grid div").removeClass("active");e(this).addClass("active");$previewButton.html(getButton());e("#tab-2-content .fasc-ico-position").removeAttr("checked");e('#tab-2-content .fasc-ico-position[value="before"]').prop("checked",true);return false});e("#tab-2-content .fasc-ico-position").change(function(t){if(e(this).val()=="none"){e("#tab-2-content .ico-grid div div:not(.clear)").removeClass("active")}else if(e(this).val()=="before"){var n=e("#tab-2-content .ico-grid div.active");if(n.length==1){}else{e(e("#tab-2-content .ico-grid div.ico-screen-active div:not(.clear)").get(0)).addClass("active")}}$previewButton.html(getButton())});$previewButton=jQuery(".preview-button-area .centered-button");e('#button-dialog select, #button-dialog input[type="checkbox"]').change(function(){$previewButton.html(getButton())});e('#button-dialog input[type="text"]').keyup(function(){$previewButton.html(getButton())});e('#button-dialog input[type="text"]').keyup(function(){$previewButton.html(getButton())});$previewButton.html(getButton());e.get(ajax_url+"?action=fasc_buttons&load=get_buttons",function(e){parseButtons(e)},"json");e(".save-btn").click(function(){var t={};t.button=getButton({isSaving:true});e.post(ajax_url+"?action=fasc_buttons&load=save_button",t,function(e){parseButtons(e)},"json");e("#tab-header li").removeClass("active");e('#tab-header li a[href="#tab-3-content"]').parent().addClass("active");loadTab("#tab-3-content");return false})})})(window.jQuery);var ButtonDialog={local_ed:"ed",init:function(e){ButtonDialog.local_ed=e;tinyMCEPopup.resizeToInnerSize();var t=top.tinymce.activeEditor.windowManager.getParams();$currentNode=t.target;$("#tab-2-content .ico-grid .grid-container").removeClass("ico-screen-active");$("#tab-2-content #"+$("#tab-2-content #icon-type-select").val()).addClass("ico-screen-active");if(source=="click"){setupFormHTML($currentNode)}else{var n=e.selection.getContent();jQuery("#button-dialog input#button-text").val(n)}$previewButton=jQuery(".preview-button-area .centered-button");$previewButton.html(getButton());refreshMiniColors($("#button-color, #text-color"))},insert:function(t){if(source=="click"){var n=t.selection.getNode();t.selection.select(n)}tinyMCEPopup.execCommand("mceReplaceContent",false,getButton());tinyMCEPopup.close()}};tinyMCEPopup.onInit.add(ButtonDialog.init,ButtonDialog)